<!DOCTYPE html>

<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta charset="utf-8">
    <title>Java Easy Batch - Performance Benchmark</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Mahmoud Ben Hassine">
    <link rel="shortcut icon" href="../resources/img/gear.ico"/>

    <link href="../resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="../resources/css/prettify.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 60px;
            padding-bottom: 15px;
        }
        .sidebar-nav {
            padding: 9px 0;
        }
    </style>
    <link href="../resources/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="../resources/css/font-awesome.min.css" rel="stylesheet">
    <link href="../resources/css/sidebar.css" rel="stylesheet">

    <script type="text/javascript" src="../resources/js/prettify.js"></script>

    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-35599235-1']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>

</head>

<body onload="prettyPrint()">

<div class="navbar navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="brand" href="../index.html"><i class="icon-cogs"></i> Easy Batch</a>
            <div class="nav-collapse collapse">
                <p class="navbar-text pull-right">Version: 2.1.1</p>
                <ul class="nav">
                    <li><a href="../index.html"><i class="icon-home"></i> Home</a></li>
                    <li class="dropdown">
                        <a id="documentation" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-book"></i> Documentation<b class="caret"></b></a>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="documentation">
                            <li><a href="../documentation/gettingStarted.html"><i class="icon-play"></i> Getting started</a></li>
                            <li><a href="../documentation/architecture.html"><i class="icon-beaker"></i> Architecture</a></li>
                            <li><a href="../documentation/benchmark.html"><i class="icon-dashboard"></i> Performance benchmark</a></li>
                            <li><a href="../documentation/userGuide.html"><i class="icon-book"></i> User Guide</a></li>
                            <li><a href="../tutorials/index.html"><i class="icon-code"></i> Tutorials</a></li>
                            <li><a href="../documentation/faq.html"><i class="icon-question"></i> FAQ</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a id="getinvolved" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-thumbs-up"></i> Get involved<b class="caret"></b></a>
                        <ul class="dropdown-menu" role="menu" aria-labelledby="getinvolved">
                            <li><a href="https://github.com/benas/easy-batch" target="_blank"><i class="icon-github"></i> Source repository</a></li>
                            <li><a href="https://github.com/benas/easy-batch/issues" target="_blank"><i class="icon-bug"></i> Issue tracker</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row-fluid">

        <div class="span3">
            <div class="well sidebar-nav bs-docs-sidenav" data-spy="affix">
                <ul class="nav nav-list">
                    <li class="nav-header">About Easy Batch</li>
                    <li><a href="../index.html"><i class="icon-home"></i> Overview</a></li>
                    <li><a href="../releaseNotes.html"><i class="icon-tags"></i> Release notes</a></li>
                    <li class="nav-header">Documentation</li>
                    <li><a href="../documentation/gettingStarted.html"><i class="icon-play"></i> Getting started</a></li>
                    <li><a href="../documentation/architecture.html"><i class="icon-beaker"></i> Architecture</a></li>
                    <li class="active"><a href="../documentation/benchmark.html"><i class="icon-dashboard"></i> Performance benchmark</a></li>
                    <li><a href="../documentation/userGuide.html"><i class="icon-book"></i> User Guide</a></li>
                    <li><a href="../tutorials/index.html"><i class="icon-code"></i> Tutorials</a></li>
                    <li><a href="../documentation/faq.html"><i class="icon-question"></i> FAQ</a></li>
                    <li class="nav-header">Get involved</li>
                    <li><a href="https://github.com/benas/easy-batch" target="_blank"><i class="icon-github"></i> Source repository</a></li>
                    <li><a href="https://github.com/benas/easy-batch/issues" target="_blank"><i class="icon-bug"></i> Issue tracker</a></li>
                </ul>
            </div>
        </div>

        <div class="span9">

            <div class="page-header">
                <h1>Performance benchmark</h1>
            </div>

            <div class="row-fluid">

                <h2 id="1" >1. Description</h2>
                    <p>In this section, we will perform a benchmark to measure the potential overhead you may have using Easy Batch.</p>
                    <p>The goal of the benchmark is to measure Easy Batch performance for reading, parsing and mapping data to domain objects.
                        We will not include record processing logic since it heavily depends on the use case.</p>
                    <p>We will perform two benchmarks:</p>
                    <ul>
                        <li>Read a Csv flat file containing customer data</li>
                        <li>Read an Xml file containing customer data</li>
                    </ul>
                    <p>We will generate random input data with 1 000 , 10 000, 100 000 and 1 000 000 records using <a href="http://benas.github.io/jPopulator/" target="_blank">jPopulator</a>.</p>

                    <p>The input Csv file has the following format:</p>
<pre class="prettyprint">
#id,firstName,lastName,birthDate,email,phone,street,zipCode,city,country
1,foo,bar,1990-12-13,foo@bar.org,0123456789,street1,zipCode1,london,uk
2,bar,foo,1990-13-12,bar@foo.org,9876543210,street2,zipCode2,newyork,usa
</pre>

                <div>
                    <div class="span6">

                <p>The input Xml file has the following format:</p>

<pre class="prettyprint">
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;customers&gt;
    &lt;customer&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;firstName&gt;foo&lt;/firstName&gt;
        &lt;lastName&gt;bar&lt;/lastName&gt;
        &lt;birthDate&gt;1990-12-13&lt;/birthDate&gt;
        &lt;email&gt;foo@bar.org&lt;/email&gt;
        &lt;phone&gt;0123456789&lt;/phone&gt;
        &lt;street&gt;street1&lt;/street&gt;
        &lt;zipCode&gt;zipCode1&lt;/zipCode&gt;
        &lt;city&gt;london&lt;/city&gt;
        &lt;country&gt;uk&lt;/country&gt;
    &lt;/customer&gt;
&lt;customers&gt;
</pre>
                    </div>
                    <div class="span6">

                <p>The domain object <code>Customer</code> is defined as follows:</p>
<pre class="prettyprint">
@XmlRootElement
public class Customer {

    private int id;
    private String firstName;
    private String lastName;
    private Date birthDate;
    private String email;
    private String phone;
    private String street;
    private String zipCode;
    private String city;
    private String country;
    //Getters and setters omitted
}
</pre>
                    </div>
                </div>

                <p>To create Easy Batch instances, we will use the following snippet:</p>

<pre class="prettyprint">
// For Csv
String[] fields = new String[] {"id", "firstName", "lastName", "birthDate",
            "email", "phone", "street", "zipCode", "city", "country"};
EasyBatchEngine easyBatchCsvEngine = new EasyBatchEngineBuilder()
    .registerRecordReader(new FlatFileRecordReader(customersFile))
    .registerRecordMapper(new DelimitedRecordMapper&ltCustomer&gt(Customer.class, fields))
    .build();

// For Xml
EasyBatchEngine easyBatchXmlEngine = new EasyBatchEngineBuilder()
    .registerRecordReader(new XmlRecordReader("customer", customersFile))
    .registerRecordMapper(new XmlRecordMapper&ltCustomer&gt(Customer.class))
    .build();
</pre>

                <p>The complete source code of the this benchmark can be found <a href="https://github.com/benas/easy-batch/tree/master/easybatch-tutorials/src/main/java/io/github/benas/easybatch/tutorials/bench" target="_blank">here</a>.</p>

                <p>To run the Csv or Xml benchmark with maven, launch the following commands in the <code>easybatch-tutorials</code> directory :</p>

                <p><span class="icon-stack"> <i class="icon-sign-blank icon-stack-base"></i> <i class="icon-terminal icon-light"></i> </span>
                    <em><strong>mvn exec:java -PrunCsvBenchmark</strong></em>
                </p>

                <p><span class="icon-stack"> <i class="icon-sign-blank icon-stack-base"></i> <i class="icon-terminal icon-light"></i> </span>
                    <em><strong>mvn exec:java -PrunXmlBenchmark</strong></em>
                </p>

                <p>Results presented in section 2 have been obtained by running the benchmark on the following configuration:</p>
                <table class="table table-bordered table-condensed table-striped table-center" style="width:50%">
                    <tbody>
                    <tr>
                        <td><strong>OS</strong></td>
                        <td>Windows 7 SP1 64 bits</td>
                    </tr>
                    <tr>
                        <td><strong>Processor</strong></td>
                        <td>Intel Core i5-2520M 2.5Ghz</td>
                    </tr>
                    <tr>
                        <td><strong>Memory</strong></td>
                        <td>4 Go</td>
                    </tr>
                    <tr>
                        <td><strong>Java runtime</strong></td>
                        <td>Oracle Jdk "1.7.0_45" 64 bits</td>
                    </tr>
                    </tbody>
                </table>
                <h2 id="2">2. Benchmark results</h2>
                <div class="row">
                    <div class="row span5 offset1" id="csvBenchChart" style="height: 400px;"></div>
                    <div class="row span5" id="xmlBenchChart" style="height: 400px;"></div>
                </div>
                <p class="text-center">The following tables summarize the record number, the file size and the processing time for each benchmark:</p>
                <table class="offset1 table table-bordered table-condensed table-striped table-center" style="width:80%">
                    <thead>
                    <tr>
                        <th>Record number</th>
                        <th>Csv file size (Ko)</th>
                        <th>Processing time (ms)</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>1 000</td>
                        <td>99</td>
                        <td>128</td>
                    </tr>
                    <tr>
                        <td>10 000</td>
                        <td>991</td>
                        <td>452</td>
                    </tr>
                    <tr>
                        <td>100 000</td>
                        <td>9 907</td>
                        <td>1 746</td>
                    </tr>
                    <tr>
                        <td>1 000 000</td>
                        <td>99 081</td>
                        <td>15 347</td>
                    </tr>
                    </tbody>
                </table>

                <table class="offset1 table table-bordered table-condensed table-striped table-center" style="width:80%">
                    <thead>
                    <tr>
                        <th>Record number</th>
                        <th>Xml file size (Ko)</th>
                        <th>Processing time (ms)</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>1 000</td>
                        <td>350</td>
                        <td>414</td>
                    </tr>
                    <tr>
                        <td>10 000</td>
                        <td>3 491</td>
                        <td>1 281</td>
                    </tr>
                    <tr>
                        <td>100 000</td>
                        <td>34 907</td>
                        <td>6 235</td>
                    </tr>
                    <tr>
                        <td>1 000 000</td>
                        <td>349 077</td>
                        <td>61 737</td>
                    </tr>
                    </tbody>
                </table>

                <p>Values of these results are the average of 5 executions.</p>

                <h2 id="3">3. Conclusion</h2>
                <p>Up to 100 000 records, Easy Batch processing time is less than 2 seconds for Csv and about 6 seconds for Xml.</p>
                <p>For a very high amount of data (1 million records),
                    Easy Batch processing time remains less than 20 seconds for Csv records and about 1 minute for Xml records which is very reasonable for a standard configuration.</p>
                <p>To conclude, there is practically no performance overhead using Easy Batch.</p>

        </div>

    </div>
    </div>

    <hr>

    <footer>
        <p class="pull-right"><a href="#"><i class="icon-circle-arrow-up"></i> Back to top</a></p>
        <p>Easy Batch is maintained by <a href="mailto:md.benhassine@gmail.com?subject=[Easy Batch]"><i class="icon-envelope"></i> benas</a> at <a href="https://github.com/benas/easy-batch" target="_blank"><i class="icon-github"></i> Github</a></p>
    </footer>

</div>
</div>

<script src="../resources/js/jquery.js"></script>
<script src="../resources/js/bootstrap.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script>
jQuery(document).ready(function () {
    jQuery('#csvBenchChart').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Csv'
        },
        tooltip: {
            enabled: false
        },
        xAxis: {
            type: 'category',
            title: {
                text: 'Number of records'
            },
            categories:['']

        },
        yAxis: {
            min: 0,
            title: {
                text: 'Processing time (ms)'
            }
        },
        credits: {
            enabled: false
        },
        plotOptions: {
            series: {
                borderWidth: 0,
                dataLabels: {
                    enabled: true,
                    format: '{point.y}ms'
                }
            }
        },
        series: [{
            name: '1000',
            data: [128]
        }, {
            name: '10 000',
            data: [452]
        }, {
            name: '100 000',
            data: [1746]
        }, {
            name: '1 000 000',
            data: [15347]
        }]
    });
    jQuery('#xmlBenchChart').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Xml'
        },
        tooltip: {
            enabled: false
        },
        xAxis: {
            title: {
                text: 'Number of records'
            },
            categories:['']
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Processing time (ms)'
            }
        },
        credits: {
            enabled: false
        },
        plotOptions: {
            series: {
                borderWidth: 0,
                dataLabels: {
                    enabled: true,
                    format: '{point.y}ms'
                }
            }
        },
        series: [{
            name: '1000',
            data: [414]
        }, {
            name: '10 000',
            data: [1281]
        }, {
            name: '100 000',
            data: [6235]
        }, {
            name: '1 000 000',
            data: [61737]
        }]
    });
});
</script>

</body>
</html>
