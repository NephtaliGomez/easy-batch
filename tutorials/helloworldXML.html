<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Java Easy Batch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Mahmoud Ben Hassine">
    <meta name="author" content="Easy Batch: batch processing with java made easy">

    <!-- Bootstrap CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="../css/font-awesome.min.css" rel="stylesheet">

    <!-- Plugins -->
    <link href="../css/highlight/obsidian.css" media="screen" rel="stylesheet" />
    <link href="../css/clingify/clingify.css" rel="stylesheet">

    <!-- Theme style -->
    <link href="../css/theme-style.min.css" rel="stylesheet">

    <!--Your custom colour override-->
    <link href="../css/colour-blue.css" id="colour-scheme" rel="stylesheet">

    <!-- Your custom override -->
    <link href="../css/custom-style.css" rel="stylesheet">

    <!-- HTML5 shiv & respond.js for IE6-8 support of HTML5 elements & media queries -->
    <!--[if lt IE 9]>
    <script src="../js/plugins/html5shiv/html5shiv.js"></script>
    <script src="../js/plugins/respond/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="../img/misc/gear.ico">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,300|Rambla|Calligraffitti' rel='stylesheet' type='text/css'>

    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-35599235-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>

</head>
<body class="page page-index-static">

<a href="#content" class="sr-only">Skip to content</a>
<div id="navigation" class="wrapper">
    <div class="navbar-static-top">

        <!--Header & Branding region-->
        <div class="header">
            <div class="header-inner container">
                <div class="row">
                    <div class="col-md-8">
                        <!--branding/logo-->
                        <a class="navbar-brand" href="../index.html" title="Home">
                            <h1><span>Easy</span>Batch</h1>
                        </a>
                        <div class="slogan">Batch processing with Java made easy!</div>
                    </div>

                </div>
            </div>
        </div>

        <div class="container" data-toggle="clingify">
            <div class="navbar">
                <!--
              mobile collapse menu button
              - data-toggle="toggle" = default BS menu
              - data-toggle="jpanel-menu" = jPanel Menu
              -->
                <a class="navbar-btn" data-toggle="jpanel-menu" data-target=".navbar-collapse"> <span class="bar"></span> <span class="bar"></span> <span class="bar"></span> <span class="bar"></span> </a>

                <!--user menu-->
                <div class="user-menu pull-right"> <a href="" data-toggle="tooltip" class="btn btn-primary">version : 2.1.3</a> </div>

                <!--everything within this div is collapsed on mobile-->
                <div class="navbar-collapse collapse">

                    <!--main navigation-->
                    <ul class="nav navbar-nav">
                        <li><a href="../index.html"><i class="fa fa-home fa-lg"></i> Home</a></li>
                        <li class="dropdown"> <a href="#" class="dropdown-toggle menu-item" id="features-drop" data-toggle="dropdown"><i class="fa fa-book fa-lg" ></i> Documentation +</a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="about-drop">
                                <li role="presentation"><a role="menuitem" href="../documentation/gettingStarted.html" class="menu-item"><i class="fa fa-play fa-lg"></i> Getting started</a></li>
                                <li role="presentation"><a role="menuitem" href="../documentation/architecture.html" tabindex="-1" class="menu-item"><i class="fa fa-flask fa-lg"></i> Architecture</a></li>
                                <li role="presentation"><a role="menuitem" href="../documentation/userGuide.html" tabindex="-1" class="menu-item"><i class="fa fa-book fa-lg"></i> User guide</a></li>
                                <li role="presentation"><a role="menuitem" href="../documentation/faq.html" tabindex="-1" class="menu-item"><i class="fa fa-question fa-lg"></i> FAQs</a></li>
                            </ul>
                        </li>
                        <li><a href="../tutorials/index.html" class="menu-item"><i class="fa fa-code fa-lg"></i> Tutorials</a></li>
                        <li class="dropdown"> <a href="" class="dropdown-toggle" id="about-drop" data-toggle="dropdown"><i class="fa fa-thumbs-o-up fa-lg"></i> Get involved +</a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="about-drop">
                                <li role="presentation"><a role="menuitem" href="https://github.com/benas/easy-batch" target="_blank" tabindex="-1" class="menu-item"><i class="fa fa-github fa-lg"></i> Source repository</a></li>
                                <li role="presentation"><a role="menuitem" href="https://github.com/benas/easy-batch/issues" target="_blank" tabindex="-1" class="menu-item"><i class="fa fa-bug fa-lg"></i> Issue tracker</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
                <!--/.navbar-collapse -->
            </div>
        </div>
    </div>
</div>

<div id="content">
    <div class="container">

        <!-- breadcrumb -->
<ul class="breadcrumb">
    <li><a href="../index.html">Home</a></li>
    
    <li><a href="../tutorials/index.html">Tutorials</a></li>
    
    
    <li class="active">Hello World XML Tutorial</li>
</ul>

        <div id="row">
            <div class="col-md-9">

                <h1 class="title-divider"><span>Hello World XML Tutorial</span></h1>

                              <h2 id="1">1. Description</h2>

            <p>This tutorial is the same as the <a href="helloworldCSV.html">Hello World CSV tutorial</a> except that greetings are read from an XML file rather than a CSV flat file.
                We will process a simple XML file containing greetings and generate greeting messages.
                To keep the tutorial simple, the input file named <code>greetings.xml</code> has the following content:</p>

<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;greetings&gt;
    &lt;greeting&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;name&gt;foo&lt;/name&gt;
    &lt;/greeting&gt;
    &lt;greeting&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;name&gt;bar&lt;/name&gt;
    &lt;/greeting&gt;
    &lt;greeting&gt;
        &lt;id&gt;x&lt;/id&gt;
        &lt;name&gt;baz&lt;/name&gt;
    &lt;/greeting&gt;
    &lt;greeting&gt;
        &lt;ref&gt;4&lt;/ref&gt;
        &lt;name&gt;blah!&lt;/name&gt;
    &lt;/greeting&gt;
&lt;/greetings&gt;</code></pre>

            <p>Each <code>greeting</code> tag is composed of 2 children tags :</p>
            <ul>
                <li>a id tag representing the greeting id</li>
                <li>a name tag representing a person name</li>
            </ul>

            <p>Easy Batch development is POJO-based, so we would like to map each <code>greeting</code> tag to an instance of the following <code>Greeting</code> bean:</p>

<pre><code class="java">@XmlRootElement
public class Greeting {

    @XmlElement
    private int id;

    @XmlElement
    private String name;

    // Getters and Setters omitted

    public String getGreetingMessage() {
        return "Hi " + name + "! Your id is " + id;
    }

}</code></pre>

            <p>Each <code>greeting</code> tag is seen as a record in Easy Batch, an "XML record".</p>
            <p>Easy Batch uses <a href="https://jaxb.java.net/" target="_blank">JAXB</a> to map XML records to java objects, so we have annotated our <code>Greeting</code> bean with JAXB annotations to map XML tags to the corresponding fields of our Pojo.</p>

            <p>For each XML record, the batch application should print to the console a greeting of the format : <em>Hi foo! Your id is 1</em> .</p>

            <p>Moreover, we would like to ignore records that do not conform to the following <code>greetings.xsd</code> file:</p>

<pre><code class="xml">&lt;?xml version="1.0"?&gt;
&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;
    &lt;xs:element name="greeting"&gt;
        &lt;xs:complexType&gt;
            &lt;xs:id&gt;
                &lt;xs:element name="id" type="xs:int"/&gt;
                &lt;xs:element name="name" type="xs:string"/&gt;
            &lt;/xs:id&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
&lt;/xs:schema&gt;</code></pre>

            <p>With this requirement, the record number 3 should be ignored since the value <code>x</code> is not a number as expected and the record number 4 should also be ignored since the tag <code>ref</code> is not expected according to the <code>greetings.xsd</code> file (a <code>id</code> tag is expected instead).</p>

            <p>You will see that all these requirements can be easily implemented using Easy Batch, so let's get started!</p>

            <h2 id="2">2. Implementation using Easy Batch</h2>
            <p>The goal of Easy Batch is to let you concentrate on your batch processing logic and to handle for you all the plumbing code of reading and mapping XML records to domain objects.</p>
            <p>First, let's implement our batch processing logic by extending the <code>AbstractRecordProcessor</code> class:</p>

<pre><code class="java">public class GreetingProcessor extends AbstractRecordProcessor&lt;Greeting&gt; {

    @Override
    public void processRecord(Greeting greeting) throws Exception {
        System.out.println(greeting.getGreetingMessage());
    }

}</code></pre>

            <p>This processor will print the greeting message for each input record as required.</p>

            <p>Actually, we have almost finished our batch implementation! We should now configure Easy Batch engine to :<p>
            <ol>
                <li>Read XML records from the <code>greetings.xml</code> file</li>
                <li>Map each XML record to an instance of the <code>Greeting</code> bean</li>
                <li>Process each XML record using our <code>GreetingProcessor</code></li>
            </ol>

            <p>The following listing provides this configuration:</p>

<pre><code class="java">public class Launcher {

public static void main(String[] args) throws Exception {

        // Build an easy batch engine
        EasyBatchEngine easyBatchEngine = new EasyBatchEngineBuilder()
            // requirement N°1
            .registerRecordReader(new XmlRecordReader( 
                "greeting", // root element tag name
                new File("greetings.xml"))) // XML data source
            // requirement N°2
            .registerRecordMapper(new XmlRecordMapper( 
                Greeting.class, // Pojo Type
                new File("greetings.xsd"))) // XSD file to validate XML records
            // requirement N°3
            .registerRecordProcessor(new GreetingProcessor()) 
            .build();

        // Run easy batch engine
        EasyBatchReport easyBatchReport = easyBatchEngine.call();

        // Print the batch execution report
        System.out.println(easyBatchReport);
    }

}</code></pre>

            <p>That's all, we can now run the batch and see the results.</p>

            <h2 id="3">3. Running the batch</h2>

            <p>The complete source code of this tutorial is available <a href="https://github.com/benas/easy-batch/tree/master/easybatch-tutorials/src/main/java/io/github/benas/easybatch/tutorials/helloworld/xml" target="_blank">here</a>.

            <p>To run the tutorial with maven, launch the following command in the <code>easybatch-tutorials</code> directory :</p>

          <p>
            <kbd><i class="fa fa-terminal"></i> mvn exec:java -PrunHelloWorldXMLTutorial</kbd>
          </p>            

            <p>If everything is ok, you should see something like the following output in the console :</p>

<pre><code>INFO: Initializing easy batch engine
INFO: Data source: /data/in/greetings.xml
INFO: Strict mode: false
INFO: Total records = 4
INFO: easy batch engine is running...
Hi foo! Your id is 1
Hi bar! Your id is 2
<span class="text-danger"><strong>SEVERE: Record #3 [StringRecord{number=3, rawContent='
    &lt;greeting&gt;
        &lt;id&gt;x&lt;/id&gt;
        &lt;name&gt;baz&lt;/name&gt;
    &lt;/greeting&gt;
    '}] has been ignored. Root exception:
    cvc-datatype-valid.1.2.1: 'x' is not a valid value for 'integer'.
SEVERE: Record #4 [StringRecord{number=4, rawContent='
    &lt;greeting&gt;
        &lt;id&gt;4&lt;/id&gt;
        &lt;name&gt;blah!&lt;/name&gt;
    &lt;/greeting&gt;
    '}] has been ignored. Root exception:
    cvc-complex-type.2.4.a: Invalid content was found starting with element 'ref'. One of '{id}' is expected.</strong></span>
INFO: Shutting down easy batch engine</code></pre>

            <p>As expected, Easy Batch processed only valid records and generated a greeting message for each person.</p>

            <p>Moreover, Easy Batch has logged precise information about which record has been ignored with the JAXB error message of the root cause.</p>

            <h2 id="4">4. Conclusion</h2>

            <p>In this tutorial, you have learned how to process data from an XML file using Easy Batch.</p>

            <p>With Easy Batch, all we have done is :</p>
            <ul>
                <li>Implementing the business logic of our batch</li>
                <li>Providing configuration meta data</li>
            </ul>

            <p>Easy Batch handled all the plumbing code of reading, filtering, parsing and mapping XML records to
                instances of our domain object <code>Greeting</code> and actually has reduced this plumbing code from hundred lines to only a very few lines! (listing above)</p>

            <p>The following table summarizes what we have done and what Easy Batch has done for us :</p>

            <table class="table table-bordered table-condensed table-striped">
                <thead>
                <tr class="info">
                    <th>Task</th>
                    <th class="pull-center">You</th>
                    <th class="pull-center">Easy Batch</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Provide configuration meta data</td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Provide record processing logic</td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                    <td></td>
                </tr>
                <tr>
                    <td>Handle I/O for XML input file</td>
                    <td></td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                </tr>
                <tr>
                    <td>Read XML file record by record</td>
                    <td></td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                </tr>
                <tr>
                    <td>Check XML records well-formedness against an XSD file</td>
                    <td></td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                </tr>
                <tr>
                    <td>Map XML records to domain objects</td>
                    <td></td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                </tr>
                <tr>
                    <td>Apply business processing logic</td>
                    <td></td>
                    <td class="pull-center"><i class="fa fa-check-circle-o"></i></td>
                </tr>
                </tbody>
            </table>

            </div>

            <div class="col-md-3 sidebar sidebar-right">
                <!-- <div class="inner" data-spy="affix" data-offset-top="40" data-offset-bottom="300"> -->
<div class="inner">
<h4>About Easy Batch</h4>
<ul class="list-lg">
    <li >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../index.html">Overview</a>
    </li>
    <li >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../releaseNotes.html">Release notes</a>
    </li>
</ul>
<h4>Documentation</h4>
<ul class="list-lg">
    <li >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../documentation/gettingStarted.html">Getting started</a>
    </li>
    <li >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../documentation/architecture.html">Architecture</a>
    </li>
    <li >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../documentation/userGuide.html">User guide</a>
    </li>
    <li  class="well" >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../tutorials/index.html">Tutorials</a>
    </li>
    <li >
        <i class="fa fa-fw fa-angle-right"></i> <a href="../documentation/faq.html">FAQs</a>
    </li>
</ul>
<h4>Get involved</h4>
<ul class="list-lg">
    <li><i class="fa fa-fw fa-angle-right"></i> <a href="https://github.com/benas/easy-batch" target="_blank">Source repository</a></li>
    <li><i class="fa fa-fw fa-angle-right"></i> <a href="https://github.com/benas/easy-batch/issues" target="_blank">Issue tracker</a></li>
</ul>
</div>
            </div>
        </div>


    </div>
</div>
<!-- FOOTER -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-4 col">
                <div class="block contact-block">
                    <h3>Documentation</h3>
                    <ul class="fa-ul">
                        <li><a href="../documentation/gettingStarted.html"><i class="fa fa-li fa-play"></i> Getting started</a></li>
                        <li><a href="../documentation/architecture.html"><i class="fa fa-li fa-flask"></i> Architecture</a></li>
                        <li><a href="../documentation/userGuide.html"><i class="fa fa-li fa-book"></i> User guide</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-4 col">
                <div class="block contact-block">
                    <h3>Tutorials</h3>
                    <ul class="fa-ul">
                    <li><a href="../tutorials/index.html#basic"><i class="fa fa-li fa-star-o"></i> Basic tutorials</a></li>
                        <li><a href="../tutorials/index.html#intermediate"><i class="fa fa-li fa-star-half-o"></i> Intermediate tutorials</a></li>
                        <li><a href="../tutorials/index.html#advanced"><i class="fa fa-li fa-star"></i> Advanced Tutorials</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-4 col">
                <div class="block contact-block">
                    <h3>Get involved</h3>
                    <ul class="fa-ul">
                        <li><a href="https://github.com/benas/easy-batch" target="_blank"><i class="fa fa-li fa-github"></i> Source repository</a></a></li>
                        <li><a href="https://github.com/benas/easy-batch/issues" target="_blank"><i class="fa fa-li fa-bug"></i> Issue tracker</a></li>
                        <li><a href="../documentation/faq.html"><i class="fa fa-li fa-question"></i> FAQs</a></li>
                    </ul>
                </div>
            </div>

        </div>

        <p class="back-top floatright" style="display: none;">
            <a href="#top"><span></span></a>
        </p>

        <div class="row">
            <div id="toplink"><a href="#top" class="top-link" title="Back to top">Back To Top <i class="fa fa-chevron-up"></i></a></div>

            <div class="subfooter">
                <div class="col-md-6">
                    <p>&copy; Easy Batch is created by <a href="http://www.mahmoudbenhassine.com" target="_blank">Mahmoud Ben Hassine</a></p>
                </div>
                <div class="col-md-6">
                    <p class="footer-menu">Easy Batch is released under the <a href="http://opensource.org/licenses/mit-license.php/" target="_blank">MIT license</a>.</p>
                </div>
            </div>
        </div>
    </div>
</footer>

<!--Scripts -->
<script src="../js/jquery.min.js"></script>
<script src="../js/jquery-migrate-1.2.1.min.js"></script> <!--Legacy jQuery support for quicksand plugin-->

<!-- Bootstrap JS -->
<script src="../js/bootstrap.min.js"></script>

<!--JS plugins-->
<script src="../js/plugins/clingify/jquery.clingify.min.js"></script>
<script src="../js/plugins/jRespond/jRespond.js"></script>

<!--Custom scripts mainly used to trigger libraries -->
<script src="../js/script.min.js"></script>
<script src="../js/scrolltotop.js"></script>
<script src="../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>